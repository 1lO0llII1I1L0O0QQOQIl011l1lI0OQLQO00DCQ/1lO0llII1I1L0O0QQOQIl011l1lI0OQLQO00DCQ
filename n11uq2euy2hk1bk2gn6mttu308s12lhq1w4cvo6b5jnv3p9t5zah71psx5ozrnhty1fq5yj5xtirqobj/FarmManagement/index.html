<html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <!-- icon -->
	 <link rel="shortcut icon" href="image/icon.ico"><!-- 透明-->
	 <link rel="icon" type="image/png" href="image/192x192.png" sizes="192x192"> <!-- 不用透明-->
	 <link rel="apple-touch-icon" sizes="120x120" href="image/120x120.png"><!-- 不用透明-->
	 <link rel="apple-touch-icon" sizes="152x152" href="image/152x152.png"><!-- 不用透明-->
	 <link rel="apple-touch-icon" sizes="180x180" href="image/180x180.png"><!-- 不用透明-->
	
    <!-- Bootstrap CSS -->
	
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link href="3.2.0/css/bootstrap.min.css?v=3" rel="stylesheet" >
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css" rel="stylesheet" >
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.0/css/bootstrapValidator.min.css" rel="stylesheet" >
	
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">

  <!-- Include the JavaScript file for Bootstrap table -->
  <script src=
"https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js">
  </script>
	<!-- 製作漸層背景 https://uigradients.com/#RedSunset -->
	<style> 
		body 
		{
			background: #43C6AC;  /* fallback for old browsers */
			background: -webkit-linear-gradient(to right, #F8FFAE, #43C6AC);  /* Chrome 10-25, Safari 5.1-6 */
			background: linear-gradient(to right, #F8FFAE, #43C6AC); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
			  height: 100%;
			  margin: 0;
			  padding: 0;
		}
		#map {
		  height: 52%;
		  width: 100%;
		  margin-top:-8px;
		  <!--margin: 0 auto; -->
		}
		#divInfowindow
		{
			width: 100px;
			margin: 0 auto; 
		}
		.highlight
		{
			background-color:#ff0000;
		}
	</style>
    <title>種魚管理</title>
	<script>
	  
		let map;
		let sheetJsonData;
		var currentPage="工廠";
		//SD
		var fishDataSD1 = "D1";
		var fishDataSD2 = "D2 ";
		var fishDataSD3 = "D3";
		var fishDataSD4 = "D4";
		var fishDataSD6 = "D6";
		var fishDataSD11 = "D11";
		var fishDataSDCircle = ['D5', 'D7', 'D8', 'D9', 'D10']; // ['D5', 'D7', 'D8', 'D9', 'D10']
		
		//JKA
		var fishDataJKA11 = "A11";
		var fishDataJKA12 = "A12";
		var fishDataJKA13 = "A13";
		var fishDataJKACircle = ['A1', 'A2', 'A3', 'A4', 'A5', 'A6', 'A7', 'A8', 'A9', 'A10'];  //['A1', 'A2', 'A3', 'A4', 'A5', 'A6', 'A7', 'A8', 'A9', 'A10']
		var fishDataJKA_G_Circle = ['G10', 'G9', 'G8', 'G7', 'G6', 'G5', 'G4', 'G3', 'G2', 'G1', ]; //['G10', 'G9', 'G8', 'G7', 'G6', 'G5', 'G4', 'G3', 'G2', 'G1', ];
		
		//JKB
		var fishDataJKBCircle = ['B1', 'B2', 'B3', 'B4', 'B5', 'B6'];
		
		//工廠
		var fishDataC1 = "C1";
		var fishDataC2 = "C2";
		var fishDataC3 = "C3";
		var fishDataC4 = "C4";
		var fishDataC5 = "C5";
		var fishDataC6 = "C6";
		var fishDatafactoryCircle = ['M20', 'M19', 'M18', 'M17', 'M16', 'M15', 'M14', 'M13', 'M12', 'M11', 'M10', 'M9', 'M8', 'M7', 'M6', 'M5', 'M4', 'M3', 'M2', 'M1', 'S6', 'S5', 'S4', 'S3', 'S2', 'S1'];
		var fishDatafactoryOutsideUnderground = ['13', '12', '11', '10', '9', '8', '7'];
		
		$.getJSON //https://sheets.googleapis.com/v4/spreadsheets/{spreadsheetId}/values/{range}?key={apiKey}
			('https://sheets.googleapis.com/v4/spreadsheets/1FvCtikKepDxRIMGmcaANmRB2y7gdwcrdKWnMrcWzfUU/values/form?alt=json&key=AIzaSyD1nv9DyD6XvqVI3MUg1j2l_yKUNl8FjUY', 
			function(data) {
				sheetJsonData = data;
				let tableRef = document.getElementById("tableID");
				
				 let tableLength = tableRef.rows.length;
				for (var i=1; i<tableLength; i++) {
					tableRef.deleteRow(1);
				}
				
				for (i = 1; i < sheetJsonData.values.length ; i++) 
				{
					var  itemNum = sheetJsonData.values[i][0];
					var  itemId = sheetJsonData.values[i][1];
					var  itemFishData =  sheetJsonData.values[i][2];
					var  itemDate=  sheetJsonData.values[i][3];
					var row = tableRef.insertRow();
					var cell1 = row.insertCell(0);
					cell1.style.display = 'none';
					var cell2 = row.insertCell(1);
					var cell3 = row.insertCell(2);
					var cell4	= row.insertCell(3);
					cell1.innerHTML = itemNum;
					cell2.innerHTML= itemId;
					cell3.innerHTML= itemFishData;
					cell4.innerHTML= itemDate;
					row.onclick = function() {
						document.getElementById("modifyNum").value= this.cells[0].innerHTML;
						document.getElementById("modifyID").innerHTML= this.cells[1].innerHTML;
						document.getElementById("modifyFishData").value= this.cells[2].innerHTML;
					 };
					mapSheetData(itemId, itemFishData);
				 }
				 initMap();
				 hideSpinner();
				 currentPage = "工廠";
				 changePositionFactory();
			});
		
		function mapSheetData(itemId, itemFishData)
		{
			switch (itemId) {
				case 'SD1':
					fishDataSD1 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case 'SD2':
					fishDataSD2 = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD3':
					fishDataSD3= "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD4':
					fishDataSD4 = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD6':
					fishDataSD6 = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD11':
					fishDataSD11 = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD5':
					fishDataSDCircle[0] = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD7':
					fishDataSDCircle[1]  = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD8':
					fishDataSDCircle[2]  = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD9':
					fishDataSDCircle[3]  = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case 'SD10':
					fishDataSDCircle[4]  = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case '建功A1':
					fishDataJKACircle[0] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A2':
					fishDataJKACircle[1] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A3':
					fishDataJKACircle[2] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A4':
					fishDataJKACircle[3] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A5':
					fishDataJKACircle[4] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A6':
					fishDataJKACircle[5] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A7':
					fishDataJKACircle[6] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A8':
					fishDataJKACircle[7] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A9':
					fishDataJKACircle[8] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A10':
					fishDataJKACircle[9] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A11':
					fishDataJKA11 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功A12':
					fishDataJKA12 = "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case '建功A13':
					fishDataJKA13= "<p><B>@" + itemId + "</B></p>" +  itemFishData;
					break;
				case '溫室G1':
					fishDataJKA_G_Circle[9] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G2':
					fishDataJKA_G_Circle[8] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G3':
					fishDataJKA_G_Circle[7] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G4':
					fishDataJKA_G_Circle[6] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G5':
					fishDataJKA_G_Circle[5] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G6':
					fishDataJKA_G_Circle[4] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G7':
					fishDataJKA_G_Circle[3] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G8':
					fishDataJKA_G_Circle[2] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G9':
					fishDataJKA_G_Circle[1] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '溫室G10':
					fishDataJKA_G_Circle[0] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功B1':
					fishDataJKBCircle[0] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功B2':
					fishDataJKBCircle[1] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功B3':
					fishDataJKBCircle[2] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功B4':
					fishDataJKBCircle[3] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功B5':
					fishDataJKBCircle[4] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '建功B6':
					fishDataJKBCircle[5] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
					
					
				case '工廠C1':
					fishDataC1 = "<p><B>@" + itemId + "</B></p>"+ itemFishData;
					break;
				case '工廠C2':
					fishDataC2 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C3':
					fishDataC3 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C4':
					fishDataC4 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C5':
					fishDataC5 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C6':
					fishDataC6 = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
					
				case '工廠C7':
					fishDatafactoryOutsideUnderground[6] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C8':
					fishDatafactoryOutsideUnderground[5] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C9':
					fishDatafactoryOutsideUnderground[4] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C10':
					fishDatafactoryOutsideUnderground[3] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C11':
					fishDatafactoryOutsideUnderground[2] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C12':
					fishDatafactoryOutsideUnderground[1] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠C13':
					fishDatafactoryOutsideUnderground[0] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
					
				case '工廠M20':
					fishDatafactoryCircle[0] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M19':
					fishDatafactoryCircle[1] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M18':
					fishDatafactoryCircle[2] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M17':
					fishDatafactoryCircle[3] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M16':
					fishDatafactoryCircle[4] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M15':
					fishDatafactoryCircle[5] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M14':
					fishDatafactoryCircle[6] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M13':
					fishDatafactoryCircle[7] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M12':
					fishDatafactoryCircle[8] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M11':
					fishDatafactoryCircle[9] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M10':
					fishDatafactoryCircle[10] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M9':
					fishDatafactoryCircle[11] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M8':
					fishDatafactoryCircle[12] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M7':
					fishDatafactoryCircle[13] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M6':
					fishDatafactoryCircle[14] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M5':
					fishDatafactoryCircle[15] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M4':
					fishDatafactoryCircle[16] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M3':
					fishDatafactoryCircle[17] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M2':
					fishDatafactoryCircle[18] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠M1':
					fishDatafactoryCircle[19] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠S6':
					fishDatafactoryCircle[20] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠S5':
					fishDatafactoryCircle[21] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠S4':
					fishDatafactoryCircle[22] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠S3':
					fishDatafactoryCircle[23] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠S2':
					fishDatafactoryCircle[24] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				case '工廠S1':
					fishDatafactoryCircle[25] = "<p><B>@" + itemId + "</B></p>" + itemFishData;
					break;
				
					/*
			//工廠
			var fishDatafactoryCircle = ['M20', 'M19', 'M18', 'M17', 'M16', 'M15', 'M14', 'M13', 'M12', 'M11', 'M10', 'M9', 'M8', 'M7', 'M6', 'M5', 'M4', 'M3', 'M2', 'M1', 'S6', 'S5', 'S4', 'S3', 'S2', 'S1'];
					*/
			}
		}
		
		function getSheetData(locationStr)
		{
				$.getJSON //https://sheets.googleapis.com/v4/spreadsheets/{spreadsheetId}/values/{range}?key={apiKey}
			('https://sheets.googleapis.com/v4/spreadsheets/1FvCtikKepDxRIMGmcaANmRB2y7gdwcrdKWnMrcWzfUU/values/form?alt=json&key=AIzaSyD1nv9DyD6XvqVI3MUg1j2l_yKUNl8FjUY', 
			function(data) {
				sheetJsonData = data;
				let tableRef = document.getElementById("tableID");
				
				 let tableLength = tableRef.rows.length;
				for (var i=1; i<tableLength; i++) {
					tableRef.deleteRow(1);
				}
				
				for (i = 1; i < sheetJsonData.values.length ; i++) 
				{
					var  itemNum = sheetJsonData.values[i][0];
					var  itemId = sheetJsonData.values[i][1];
					var  itemFishData =  sheetJsonData.values[i][2];
					var  itemDate=  sheetJsonData.values[i][3];
					if (itemId.indexOf(locationStr) >= 0) {
						var row = tableRef.insertRow();
						var cell1 = row.insertCell(0);
						cell1.style.display = 'none';
						var cell2 = row.insertCell(1);
						var cell3 = row.insertCell(2);
						var cell4	= row.insertCell(3);
						cell1.innerHTML = itemNum;
						cell2.innerHTML= itemId;
						cell3.innerHTML= itemFishData;
						cell4.innerHTML= itemDate;
						row.onclick = function() {
							document.getElementById("modifyNum").value= this.cells[0].innerHTML;
							document.getElementById("modifyID").innerHTML= this.cells[1].innerHTML;
							document.getElementById("modifyFishData").value= this.cells[2].innerHTML;
						 };
						 
					//mapSheetData(itemId, itemFishData);
					 }
					 
				 }
			});
			initMap();
		}
		
		function getSheetData(locationStr1, locationStr2)
		{
			$.getJSON //https://sheets.googleapis.com/v4/spreadsheets/{spreadsheetId}/values/{range}?key={apiKey}
			('https://sheets.googleapis.com/v4/spreadsheets/1FvCtikKepDxRIMGmcaANmRB2y7gdwcrdKWnMrcWzfUU/values/form?alt=json&key=AIzaSyD1nv9DyD6XvqVI3MUg1j2l_yKUNl8FjUY', 
			function(data) {
				sheetJsonData = data;
				let tableRef = document.getElementById("tableID");
				
				 let tableLength = tableRef.rows.length;
				for (var i=1; i<tableLength; i++) {
					tableRef.deleteRow(1);
				}
				
				for (i = 1; i < sheetJsonData.values.length ; i++) 
				{
					var  itemNum = sheetJsonData.values[i][0];
					var  itemId = sheetJsonData.values[i][1];
					var  itemFishData =  sheetJsonData.values[i][2];
					var  itemDate=  sheetJsonData.values[i][3];
					if (itemId.indexOf(locationStr1) >=0 || itemId.indexOf(locationStr2) >= 0) 
					{
						var row = tableRef.insertRow();
						var cell1 = row.insertCell(0);
						cell1.style.display = 'none';
						var cell2 = row.insertCell(1);
						var cell3 = row.insertCell(2);
						var cell4	= row.insertCell(3);
						cell1.innerHTML = itemNum;
						cell2.innerHTML= itemId;
						cell3.innerHTML= itemFishData;
						cell4.innerHTML= itemDate;
						row.onclick = function() {
							document.getElementById("modifyNum").value= this.cells[0].innerHTML;
							document.getElementById("modifyID").innerHTML= this.cells[1].innerHTML;
							document.getElementById("modifyFishData").value= this.cells[2].innerHTML;
						 };
						 
					//mapSheetData(itemId, itemFishData);
					 }
					 
				 }
			});
			initMap();
		}
		
		function initMap() {
			map = new google.maps.Map(document.getElementById("map"), {
			center: { lat: 22.487805495806526, lng: 120.5802124740907 },
			zoom: 20,
			mapTypeId:'satellite',
			fullscreenControl:false,
			mapTypeControl:false,
			streetViewControl: false,
			zoomControl: false
			});
			
			var prev_infowindow =false; 
			
			
			var circleIcon = {
				url: "", // url image/circle_icon.svg
				scaledSize: new google.maps.Size(22, 22), // scaled size
				anchor: new google.maps.Point(11, 11),
			};
			
			// 畫多邊形 https://www.oxxostudio.tw/articles/201802/google-maps-11-polygon.html

			// SD
			var pointsSD1 = [
			{lat: 22.48696625931048 , lng:  120.57782738299524},// 左上
			{lat: 22.486613216486916, lng: 120.57780009054511},    // 左中 
			{lat: 22.486321815388724, lng: 120.57785770794118},    // 左下 
			{lat: 22.486694472452996 , lng:  120.5784369143964},   //右下
			{lat: 22.48711476118105, lng:  120.5782367697573} //右上 
			];
			var pointsSD2 = [
			{lat: 22.487442585492754 , lng:  120.57782738299524},// 左上
			{lat: 22.48696625931048, lng: 120.57783951297336},    // 左下
			{lat: 22.48711476118105 , lng:  120.5782367697573},   //右下 
			{lat: 22.487591086852277, lng:  120.57805482008548} //右上
			];
			var pointsSD3 = [
			{lat: 22.48711476118105 , lng:  120.5782367697573},// 左上
			{lat: 22.486694472452996, lng: 120.5784369143964},    // 左下
			{lat: 22.48705311890575 , lng:  120.57881900870717},   //右下
			{lat: 22.487378141458084, lng:  120.57866435148551} //右上 
			];
			var pointsSD4 = [
			{lat: 22.487591086852277 , lng:  120.57805482008548},// 左上
			{lat: 22.48711476118105, lng: 120.5782367697573},    // 左下
			{lat: 22.487378141458084 , lng:  120.57866435148551}, //右下
			{lat: 22.487927315748305, lng:  120.57833684207627} //右上
			];
			var pointsSD8 = [
			{lat: 22.4865189797307  , lng:  120.578602071532},// 左上
			{lat: 22.4862860212708, lng: 120.578819330452},    // 左下
			{lat: 22.4864025003537 , lng:  120.578982945194}, //右下
			{lat: 22.4866354588136, lng:  120.578765686274} //右上
			];
			var pointsSD11 = [
			{lat: 22.485914278230016  , lng:  120.57834726167658},// 左上
			{lat: 22.485678840458025, lng: 120.5782641132014},    // 左下
			{lat: 22.485614404787466 , lng:  120.57856452059565}, //右下
			{lat: 22.485854799251744, lng:  120.57859402489333} //右上
			];
			
			
			var pathSD1 = new google.maps.Polygon({
			paths: pointsSD1,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'D1',
			map:map
			});   
			var pathSD2 = new google.maps.Polygon({
			paths: pointsSD2,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'D2',
			map:map
			});   
			var pathSD3 = new google.maps.Polygon({
			paths: pointsSD3,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'D3',
			map:map
			});   
			var pathSD4 = new google.maps.Polygon({
			paths: pointsSD4,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'D4',
			map:map
			});   
			var pathSD8 = new google.maps.Polygon({
			paths: pointsSD8,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#613030',
			fillOpacity: 0.5,
			label: 'D8',
			map:map
			});   
			var pathSD11 = new google.maps.Polygon({
			paths: pointsSD11,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#613030',
			fillOpacity: 0.5,
			label: 'D11',
			map:map
			});   
			
			var markerSD1 = new google.maps.Marker({
			position:  { lat:  22.48670690526174, lng: 120.57810758870731 },
			map: map,
			label: 'D1',
			});
			var markerSD2 = new google.maps.Marker({
			position:  { lat:  22.48714580378559, lng: 120.57804099929017 }, 
			map: map,
			label: 'D2',
			});
			var markerSD3 = new google.maps.Marker({
			position:  { lat:  22.486879406755364, lng: 120.5784713986229 },
			map: map,
			label: 'D3',
			});
			var markerSD4 = new google.maps.Marker({
			position:  { lat:  22.48728107329031, lng: 120.57836788824318 },
			map: map,
			label: 'D4',
			});
			var markerSD6 = new google.maps.Marker({
			position:  { lat:  22.486326912940388, lng: 120.578804578307 },
			map: map,
			label: 'D6',
			});
			var markerSD11 = new google.maps.Marker({
			position:  { lat:  22.485645383481213, lng: 120.57847198439455 },
			map: map,
			label: 'D11',
			});
			
			let infowindowSD1 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSD1+ "</h5></div>" // 支援html
			});
			markerSD1.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowSD1;
				infowindowSD1.open(this.map, markerSD1);
			});
			
			let infowindowSD2 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSD2+ "</h5></div>" // 支援html
			});
			markerSD2.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowSD2;
			  infowindowSD2.open(this.map, markerSD2);
			});
			
			let infowindowSD3 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSD3+ "</h5></div>" // 支援html
			});
			markerSD3.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowSD3;
			  infowindowSD3.open(this.map, markerSD3);
			});
			
			let infowindowSD4 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSD4+ "</h5></div>" // 支援html
			});
			markerSD4.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowSD4;
			  infowindowSD4.open(this.map, markerSD4);
			});
			
			let infowindowSD6 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSD6+ "</h5></div>" // 支援html
			});
			markerSD6.addListener('click', e => {
			if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowSD6;
			  infowindowSD6.open(this.map, markerSD6);
			});
			
			let infowindowSD11 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSD11+ "</h5></div>" // 支援html
			});
			markerSD11.addListener('click', e => {
			if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowSD11;
			  infowindowSD11.open(this.map, markerSD11);
			});
			
			// SD圓池
			var positionCircleSD = [{ 
				lat: 22.4866627198558, //D5
				lng: 120.57865839790638
				}, {
				lat: 22.486424805075764, //D7
				lng: 120.57856988501342
				},{ 
				lat: 22.4863479783407, //D8
				lng: 120.57865571569751
				}, {
				lat: 22.485973757182737, //D9
				lng: 120.57842772794291
				}, {
				lat: 22.485936582840285, //D10
				lng: 120.5785376985069
				}
			];
			
			var SDCircleNum = ['D5', 'D7', 'D8', 'D9', 'D10'];
			var SDCircle = [];
			var SDCircleMarker = [];
			var SDCircleInfowindow = [];
			positionCircleSD.forEach(function(e, i) {
				SDCircle[i] = new google.maps.Circle({
					center: e,
					radius: 6,
					strokeOpacity: 0,
					fillColor: '#00FFFF',
					fillOpacity: 0.5,
					map: map
				});
			SDCircleMarker[i] = new google.maps.Marker({
			  position: e,
			  map: map,
			  icon: circleIcon,
			  label: {
				fontSize: "9pt",
				text: SDCircleNum[i].toString()
			  }
			});
			SDCircleInfowindow[i] = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataSDCircle[i]+ "</h5></div>" // 支援html
			});
			  SDCircleMarker[i].addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = SDCircleInfowindow[i];
				SDCircleInfowindow[i].open(this.map, SDCircleMarker[i]);
			});
			SDCircleMarker[i].addListener('closeclick', ()=>{
			  SDCircleInfowindow[i].close();
			});

			});

			// A區戶外圓池
			var positionCircleJKA = [{ 

				lat: 22.478821285507284, //1
				lng: 120.5686193362054
				}, {
				lat: 22.4788055579031, //2
				lng: 120.5687799532860
				},{ 
				lat: 22.47879050988144, //3
				lng: 120.56892636151325
				}, {
				lat: 22.4787757849128, //4
				lng: 120.5690844428330
				}, {
				lat: 22.4789588887119, //5
				lng: 120.5686687904360
				}, {
				lat: 22.4789462352040, //6
				lng: 120.5688186186260
				}, {
				lat: 22.4789335816960, //7
				lng: 120.5689684468150
				}, {
				lat: 22.4789209281881, //8
				lng: 120.5691182750050
				}, {
				lat: 22.478864680767234, //922., 120.22., 120.
				lng: 120.56940020630009
				}, {
				lat: 22.478865300371346, //10
				lng: 120.5697039664661
				}

			];
			
			var JKACircleNum = ['A1', 'A2', 'A3', 'A4', 'A5', 'A6', 'A7', 'A8', 'A9', 'A10'];
			var JKACircle = [];
			var JKACircleMarker = [];
			var JKACircleInfowindow = [];
			positionCircleJKA.forEach(function(e, i) {
			if(i<8)
			{
				JKACircle[i] = new google.maps.Circle({
					center: e,
					radius: 7.5,
					strokeOpacity: 0,
					fillColor: '#00E3E3',
					fillOpacity: 0.6,
					map: map
				});
			}
			else
			{
				JKACircle[i] = new google.maps.Circle({
						center: e,
						radius: 15,
						strokeOpacity: 0,
						fillColor: '#00E3E3',
						fillOpacity: 0.6,
						map: map
					});
			}
			JKACircleMarker[i] = new google.maps.Marker({
			  position: e,
			  map: map,
			  icon: circleIcon,
			  label: {
				fontSize: "9pt",
				text: JKACircleNum[i].toString()
			  }
			});
			JKACircleInfowindow[i] = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataJKACircle[i]+ "</h5></div>" // 支援html
			});
			  JKACircleMarker[i].addListener('click', e => {
			  if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = JKACircleInfowindow[i];
				JKACircleInfowindow[i].open(this.map, JKACircleMarker[i]);
			});
			JKACircleMarker[i].addListener('closeclick', ()=>{
			  JKACircleInfowindow[i].close();
			});

			});
			
			// A區戶外大池
			var pointsJKA11 = [
			{lat: 22.478690485704032 , lng:  120.56847570492755},// 左上22., 120.
			{lat: 22.478539274806703, lng: 120.56841808372751},    // 左下 22., 120.
			{lat: 22.478472188228956 , lng:  120.56884217575993},   //右下22., 120.
			{lat: 22.478662799214042, lng:  120.56885946211993} //右上 22., 120.
			];
			var pointsJKA12 = [
			{lat: 22.478662799214042 , lng:  120.56885946211993},// 左上22., 120.
			{lat: 22.478472188228956, lng: 120.56884217575993},    // 左下22., 120.
			{lat: 22.478423204355714 , lng:  120.56925935325923},   //右下 22., 120.
			{lat: 22.478635112716233, lng:  120.56926857265123} //右上22., 120.
			];
			var pointsJKA13 = [
			{lat: 22.478635112716233 , lng:  120.56926857265123},// 左上22., 120.
			{lat: 22.478423204355714, lng: 120.56925935325923},    // 左下22., 120.
			{lat: 22.478365701529054 , lng:  120.57007411703493},   //右下22., 120.
			{lat: 22.478694745161715, lng:  120.57004415401092} //右上 22., 120.
			];
			
			var pathJKA11 = new google.maps.Polygon({
			paths: pointsJKA11,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'A11',
			map:map
			});   
			var pathJKA12 = new google.maps.Polygon({
			paths: pointsJKA12,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'A12',
			map:map
			});   
			var pathJKA13 = new google.maps.Polygon({
			paths: pointsJKA13,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#006030',
			fillOpacity: 0.5,
			label: 'A13',
			map:map
			});   
			
			
			
			var markerJKA11 = new google.maps.Marker({
			position:  { lat:  22.478541665945322, lng: 120.5686352200864 },
			map: map,
			label: 'A11',
			});
			var markerJKA12 = new google.maps.Marker({
			position:  { lat:  22.47850120102999, lng: 120.56904778786436 }, 
			map: map,
			label: 'A12',
			});
			var markerJKA13 = new google.maps.Marker({
			position:  { lat:  22.478475644235285, lng: 120.56966548710734 },
			map: map,
			label: 'A13',
			});
		
			let infowindowJKA11 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataJKA11+ "</h5></div>" // 支援html
			});
			markerJKA11.addListener('click', e => {
			  if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowJKA11;
			  infowindowJKA11.open(this.map, markerJKA11);
			});
			
			let infowindowJKA12 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataJKA12+ "</h5></div>" // 支援html
			});
			markerJKA12.addListener('click', e => {
			  if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowJKA12;
			  infowindowJKA12.open(this.map, markerJKA12);
			});
			
			let infowindowJKA13 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataJKA13+ "</h5></div>" // 支援html
			});
			markerJKA13.addListener('click', e => {
			  if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowJKA13;
			  infowindowJKA13.open(this.map, markerJKA13);
			});
			
			// A區_G_室內溫室
			var positionCircleJKA_G_ = [{
				lat: 22.4789704188038, //10
				lng: 120.5699656616480
				}, {
				lat: 22.4789155838385, //9
				lng: 120.5699641529050
				}, {
				lat: 22.4788607488731, //8
				lng: 120.5699626441630
				}, {
				lat: 22.4788059139078, //7
				lng: 120.5699611354200
				}, {
				lat: 22.4787510789425, //6
				lng: 120.5699596266780
				}, { 
				lat: 22.4789716580110, //5
				lng: 120.5698838542740
				}, {
				lat: 22.4789169779477, //4
				lng: 120.5698818426170
				},{ 
				lat: 22.4788622978843, //3
				lng: 120.5698798309610
				}, {
				lat: 22.4788076178210, //2
				lng: 120.5698778193040
				}, {
				lat: 22.4787529377576, //1
				lng: 120.5698758076470
				}, 

			];
			
			var JKA_G_CircleNum = ['G10', 'G9', 'G8', 'G7', 'G6', 'G5', 'G4', 'G3', 'G2', 'G1', ];
			var JKA_G_Circle = [];
			var JKA_G_CircleMarker = [];
			var JKA_G_CircleInfowindow = [];
			positionCircleJKA_G_.forEach(function(e, i) {
				JKA_G_Circle[i] = new google.maps.Circle({
					center: e,
					radius: 3,
					strokeOpacity: 0,
					fillColor: '#28FF28',
					fillOpacity: 0.6,
					map: map
				});
			
			JKA_G_CircleMarker[i] = new google.maps.Marker({
			  position: e,
			  map: map,
			  icon: circleIcon,
			  label: {
				fontSize: "9pt",
				text: JKA_G_CircleNum[i].toString()
			  }
			});
			JKA_G_CircleInfowindow[i] = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataJKA_G_Circle[i]+ "</h5></div>" // 支援html
			});
			  JKA_G_CircleMarker[i].addListener('click', e => {
			  if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = JKA_G_CircleInfowindow[i];
				JKA_G_CircleInfowindow[i].open(this.map, JKA_G_CircleMarker[i]);
			});
			JKA_G_CircleMarker[i].addListener('closeclick', ()=>{
			  JKA_G_CircleInfowindow[i].close();
			});

			});
			
			// B區戶外圓池
			var positionCircleJKB = [{ 

				lat: 22.476537336151434, //1
				lng: 120.56787257056592
				}, {
				lat: 22.476467181366868, //2
				lng: 120.56828254989881
				},{ 
				lat: 22.476422537394548, //3
				lng: 120.56880158097339
				}, {
				lat: 22.476386822205825, //4
				lng: 120.56932475329069
				}, {
				lat: 22.476366413522406, //5
				lng: 120.56982169794462
				}, {
				lat: 22.476416159682678, // 6 
				lng: 120.57022063406974
				}

			];
			
			var JKBCircleNum = ['B1', 'B2', 'B3', 'B4', 'B5', 'B6'];
			var JKBCircle = [];
			var JKBCircleMarker = [];
			var JKBCircleInfowindow = [];
			positionCircleJKB.forEach(function(e, i) {
			if(i==0 || i==5)
			{
				JKBCircle[i] = new google.maps.Circle({
					center: e,
					radius: 15,
					strokeOpacity: 0,
					fillColor: '#FFFFAA',
					fillOpacity: 0.6,
					map: map
				});
			}
			else if  (i==4)
			{
				JKBCircle[i] = new google.maps.Circle({
						center: e,
						radius: 24,
						strokeOpacity: 0,
						fillColor: '#FFFFAA',
						fillOpacity: 0.6,
						map: map
					});
			}
			else
			{
				JKBCircle[i] = new google.maps.Circle({
						center: e,
						radius: 25,
						strokeOpacity: 0,
						fillColor: '#FFFFAA',
						fillOpacity: 0.6,
						map: map
					});
			}
			JKBCircleMarker[i] = new google.maps.Marker({
			  position: e,
			  map: map,
			  icon: circleIcon,
			  label: {
				fontSize: "9pt",
				text: JKBCircleNum[i].toString()
			  }
			});
			JKBCircleInfowindow[i] = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataJKBCircle[i]+ "</h5></div>" // 支援html
			});
			  JKBCircleMarker[i].addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = JKBCircleInfowindow[i];
				JKBCircleInfowindow[i].open(this.map, JKBCircleMarker[i]);
			});
			JKBCircleMarker[i].addListener('closeclick', ()=>{
			  JKBCircleInfowindow[i].close();
			});

			});
			
			
			// 工廠
			
			var pointsFactoryOutsideBig1 = [
			{lat: 22.487617786919536 , lng:  120.5798839400063},
			{lat: 22.48777844272328, lng: 120.58015199268027},
			{lat: 22.487580613021013 , lng:  120.58034393884053},
			{lat: 22.487363765064153, lng:  120.58012064494778}
			];
			var pointsFactoryOutsideBig2 = [
			{lat: 22.48762192417299 , lng:  120.57988195071215},
			{lat: 22.48784443543263, lng: 120.57976111367753},
			{lat: 22.487978099268084 , lng:  120.57999598002226},
			{lat: 22.487783107278204, lng:  120.58015085565673}
			];
			var pointsFactoryOutsideBig3 = [
			{lat: 22.487991332617835 , lng:  120.58001491035199},
			{lat: 22.488128768293212, lng: 120.58027809518772},
			{lat: 22.487901331223778 , lng:  120.58037692436582},
			{lat: 22.487792964929323, lng:  120.58017147738398}
			];
			
			var pointsFactoryOutsideFRP1 = [
			{lat: 22.4879573635874 , lng:  120.58036833313733},
			{lat: 22.487920189777686, lng: 120.58038375583894},
			{lat: 22.487935059302767 , lng:  120.58042667118248},
			{lat: 22.48797409179851, lng:  120.58040923682417}
			];
			var pointsFactoryOutsideFRP2 = [
			{lat: 22.48800816777786 , lng:  120.58034620491331},
			{lat: 22.487968515728372, lng: 120.58036363927164},
			{lat: 22.487985243938134 , lng:  120.58040789571967},
			{lat: 22.48802427641972, lng:  120.58038979080911}
			];
			var pointsFactoryOutsideFRP3 = [
			{lat: 22.48802737423526 , lng:  120.58039850798828},
			{lat: 22.4879889613178, lng: 120.58041594234659},
			{lat: 22.48800506996191 , lng:  120.58045684603341},
			{lat: 22.488043482874886, lng:  120.58044008222733}
			];
			
			//工廠斗池7池
			
/*
右上-左上
1-4	22.4878598037920 	120.5803217058930 
1-1.2-4	22.4878515147398 	120.5803047081560 
2-1.3-4	22.4878432256877 	120.5802877104190 
3-1.4-4	22.4878349366355 	120.5802707126820 
4-1.5-4	22.4878266475834 	120.5802537149450 
5-1.6-4	22.4878183585312 	120.5802367172080 
6-1.7-4	22.4878100694791 	120.5802197194710 
XX	22.4878017804269 	120.5802027217340 
7-1	22.4877934913748 	120.5801857239970 

右下-左下
1-3	22.4878393391139 	120.5803339160430 
1-2.2-3	22.4878312847808 	120.5803166493230 
2-2.3-3	22.4878232304477 	120.5802993826030 
3-2.4-3	22.4878151761146 	120.5802821158820 
4-2.5-3	22.4878071217815 	120.5802648491620 
5-2.6-3	22.4877990674484 	120.5802475824420 
6-2.7-3	22.4877910131153 	120.5802303157220 
XX	22.4877829587822 	120.5802130490010 
7-2	22.4877749044491 	120.5801957822810 


 */

			var pointsFactoryOutsideUnderground1 = [
			{lat: 22.4878515147398 , lng:  120.5803047081560},
			{lat: 22.4878312847808, lng: 120.5803166493230},
			{lat: 22.4878393391139 , lng:  120.5803339160430},
			{lat: 22.4878598037920, lng:  120.5803217058930}
			];
			var pointsFactoryOutsideUnderground2 = [
			{lat: 22.4878432256877 , lng:  120.5802877104190},
			{lat: 22.4878232304477, lng: 120.5802993826030},
			{lat: 22.4878312847808 , lng:  120.5803166493230},
			{lat: 22.4878515147398, lng:  120.5803047081560}
			];
			var pointsFactoryOutsideUnderground3 = [
			{lat: 22.4878349366355 , lng:  120.5802707126820},
			{lat: 22.4878151761146, lng: 120.5802821158820},
			{lat: 22.4878232304477 , lng:  120.5802993826030},
			{lat: 22.4878432256877, lng:  120.5802877104190}
			];

			var pointsFactoryOutsideUnderground4 = [
			{lat: 22.4878266475834 , lng:  120.5802537149450},
			{lat: 22.4878071217815, lng: 120.5802648491620},
			{lat: 22.4878151761146 , lng:  120.5802821158820},
			{lat: 22.4878349366355, lng:  120.5802707126820}
			];
			var pointsFactoryOutsideUnderground5 = [
			{lat: 22.4878183585312 , lng:  120.5802367172080},
			{lat: 22.4877990674484, lng: 120.5802475824420},
			{lat: 22.4878071217815 , lng:  120.5802648491620},
			{lat: 22.4878266475834, lng:  120.5802537149450}
			];
			
			var pointsFactoryOutsideUnderground6 = [
			{lat: 22.4878100694791 , lng:  120.5802197194710},
			{lat: 22.4877910131153, lng: 120.5802303157220},
			{lat: 22.4877990674484 , lng:  120.5802475824420},
			{lat: 22.4878183585312, lng:  120.5802367172080}
			];
			
			var pointsFactoryOutsideUnderground7 = [
			{lat: 22.4877934913748 , lng:  120.5801857239970},
			{lat: 22.4877749044491, lng: 120.5801957822810},
			{lat: 22.4877910131153 , lng:  120.5802303157220},
			{lat: 22.4878100694791, lng:  120.5802197194710}
			];
			var pathFactoryOutsideBig1 = new google.maps.Polygon({
			paths: pointsFactoryOutsideBig1,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF8000',
			fillOpacity: 0.35,
			label: 'C1',
			map:map
			});   
			var pathFactoryOutsideBig2 = new google.maps.Polygon({
			paths: pointsFactoryOutsideBig2,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF8000',
			fillOpacity: 0.35,
			label: 'C2',
			map:map
			});   
			var pathFactoryOutsideBig3 = new google.maps.Polygon({
			paths: pointsFactoryOutsideBig3,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF8000',
			fillOpacity: 0.35,
			label: 'C3',
			map:map
			});   
			
			var pathFactoryOutsideFRP1 = new google.maps.Polygon({
			paths: pointsFactoryOutsideFRP1,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FFD306',
			fillOpacity: 0.5,
			label: 'C4',
			map:map
			});   
			var pathFactoryOutsideFRP2 = new google.maps.Polygon({
			paths: pointsFactoryOutsideFRP2,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FFD306',
			fillOpacity: 0.5,
			label: 'C5',
			map:map
			});   
			var pathFactoryOutsideFRP3 = new google.maps.Polygon({
			paths: pointsFactoryOutsideFRP3,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 3,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FFD306',
			fillOpacity: 0.5,
			label: 'C6',
			map:map
			});   	
			
			var pathFactoryOutsideUnderground1 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground1,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C7',
			map:map
			});   
			var pathFactoryOutsideUnderground2 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground2,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C8',
			map:map
			});   
			var pathFactoryOutsideUnderground3 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground3,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C9',
			map:map
			});   
			var pathFactoryOutsideUnderground4 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground4,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C10',
			map:map
			});   
			var pathFactoryOutsideUnderground5 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground5,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C11',
			map:map
			});   
			var pathFactoryOutsideUnderground6 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground6,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C12',
			map:map
			});   
			var pathFactoryOutsideUnderground7 = new google.maps.Polygon({
			paths: pointsFactoryOutsideUnderground7,
			strokeColor: '#ffffff',
			strokeOpacity: .5,
			strokeWeight: 2,
			strokePosition: google.maps.StrokePosition.CENTER,
			fillColor: '#FF79BC',
			fillOpacity: 0.8,
			label: 'C13',
			map:map
			});   
			
			var markerFactoryOutsideBig1 = new google.maps.Marker({
			position:  { lat:  22.487681171106185, lng: 120.58013656998223 },
			map: map,
			label: 'C1',
			});
			var markerFactoryOutsideBig2 = new google.maps.Marker({
			position:  { lat:  22.48779764921287, lng: 120.58004001046538 },
			map: map,
			label: 'C2',
			});
			var markerFactoryOutsideBig3 = new google.maps.Marker({
			position:  { lat:  22.48788996423699, lng: 120.58018484974588 },
			map: map,
			label: 'C3',
			});
			var markerFactoryOutsideFRP1 = new google.maps.Marker({
			position:  { lat:  22.487946831008987, lng: 120.58039783743602 },
			map: map,
			icon: circleIcon,
			label: 'C4',
			});
			var markerFactoryOutsideFRP2 = new google.maps.Marker({
			position:  { lat:  22.487996396076856, lng: 120.58037906197323 },
			map: map,
			icon: circleIcon,
			label: 'C5',
			});
			var markerFactoryOutsideFRP3 = new google.maps.Marker({
			position:  { lat:  22.488015602535885, lng: 120.58043136504817 },
			map: map,
			icon: circleIcon,
			label: 'C6',
			});
			
			var markerFactoryOutsidePinkC = new google.maps.Marker({
			position:  { lat:  22.487779113070825, lng: 120.58017845657014 },
			map: map,
			icon: circleIcon,
			fillColor: "blue",
			 label :{
				text: "C",
				color: "#FF95CA",
				fontSize: "20px",},
			});
			
			var positionOutsideUndergroundFactory = [
			{
			lat: 22.487791477047306, // 7  C13
			lng: 120.5802054149006
			} , {
			lat: 22.48780358885068, //6  C12
			lng: 120.58023342467172
			} , {
			lat: 22.487811023619674, //5  C11
			lng: 120.58025220013452
			} , {
			lat: 22.4878196795127, //4  C1022., 120.
			lng: 120.58026946326243
			} , {
			lat: 22.487828058634772, //3  C922., 120.22., 120.
			lng: 120.58028641548124
			} , {
			lat: 22.487837045308055, //2  C8
			lng: 120.58030383265724
			} , {
			lat: 22.48784448007525, //1  C7
			lng: 120.58032059646331
			}
			];
			
			
			var factoryOutsideUndergroundNum = ['13', '12', '11', '10', '9', '8', '7'];
			var factoryOutsideUndergroundMarker = [];
			var factoryOutsideUndergroundInfowindow = [];

			positionOutsideUndergroundFactory.forEach(function(e, i) {
				
			  factoryOutsideUndergroundMarker[i] = new google.maps.Marker({
			  position: e,
			  map: map,
			  icon: circleIcon,
			  label: {
				fontSize: "9pt",
				text: factoryOutsideUndergroundNum[i].toString()
			  }
			});
			factoryOutsideUndergroundInfowindow[i] = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDatafactoryOutsideUnderground[i]+ "</h5></div>" // 支援html
			});

			  factoryOutsideUndergroundMarker[i].addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = factoryOutsideUndergroundInfowindow[i];
				factoryOutsideUndergroundInfowindow[i].open(this.map, factoryOutsideUndergroundMarker[i]);
			});

			});
			
			 // info window  https://www.letswrite.tw/google-map-api-marker-custom/
			 
			let infowindowFactoryOutsideBig1 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataC1+ "</h5></div>" // 支援html
			});
			markerFactoryOutsideBig1.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowFactoryOutsideBig1;
			  infowindowFactoryOutsideBig1.open(this.map, markerFactoryOutsideBig1);
			  
			});
			let infowindowFactoryOutsideBig2 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataC2+ "</h5></div>" // 支援html
			});
			markerFactoryOutsideBig2.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowFactoryOutsideBig2;
			  infowindowFactoryOutsideBig2.open(this.map, markerFactoryOutsideBig2);
			});
			let infowindowFactoryOutsideBig3 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataC3+ "</h5></div>" // 支援html
			});
			markerFactoryOutsideBig3.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowFactoryOutsideBig3;
			  infowindowFactoryOutsideBig3.open(this.map, markerFactoryOutsideBig3);
			});
			let infowindowFactoryOutsideFRP1 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataC4+ "</h5></div>" // 支援html
			});
			markerFactoryOutsideFRP1.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowFactoryOutsideFRP1;
			  infowindowFactoryOutsideFRP1.open(this.map, markerFactoryOutsideFRP1);
			});
			let infowindowFactoryOutsideFRP2 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataC5+ "</h5></div>" // 支援html
			});
			markerFactoryOutsideFRP2.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowFactoryOutsideFRP2;
			  infowindowFactoryOutsideFRP2.open(this.map, markerFactoryOutsideFRP2);
			});
			let infowindowFactoryOutsideFRP3 = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDataC6+ "</h5></div>" // 支援html
			});
			markerFactoryOutsideFRP3.addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = infowindowFactoryOutsideFRP3;
			  infowindowFactoryOutsideFRP3.open(this.map, markerFactoryOutsideFRP3);
			});
			
			
			  
		  
			// 畫工廠圓池 https://www.oxxostudio.tw/articles/201802/google-maps-12-rect-circle.html
			var positionCircleFactory = [{ 
			lat: 22.4877558202967, //20
			lng: 120.5802069585460
			}, {
			lat: 22.4877405971288, //19
			lng: 120.5802210535970
			}, {
			lat: 22.4877253739610, //18
			lng: 120.5802351486480
			}, {
			lat: 22.4877101507931, //17
			lng: 120.5802492436990
			}, {
			lat: 22.4876949276253, //16
			lng: 120.5802633387500
			}, {
			lat: 22.4876797044574, //15
			lng: 120.5802774338020
			}, {
			lat: 22.4876644812896, //14
			lng: 120.5802915288530
			}, {
			lat: 22.4876492581217, //13
			lng: 120.5803056239040
			}, {
			lat: 22.4876340349538, //12
			lng: 120.5803197189550
			}, {
			lat: 22.4876188117860, //11
			lng: 120.5803338140060
			} , {
			lat: 22.48765124342743, //10 
			lng: 120.5803479621493
			} , {
			lat: 22.487636373870973, //9 
			lng: 120.58036472595373
			} , {
			lat: 22.4876524825561, //8
			lng: 120.5803915480420
			} , {
			lat: 22.4876677061419, //7
			lng: 120.5803782327910
			} , {
			lat: 22.4876829297277, //6
			lng: 120.5803649175390
			} , {
			lat: 22.4876981533135, //5
			lng: 120.5803516022880
			} , {
			lat: 22.4877133768993, //4
			lng: 120.5803382870370
			} , {
			lat: 22.4877286004851, //3
			lng: 120.5803249717860
			} , {
			lat: 22.4877438240709, //2
			lng: 120.5803116565340
			} , {
			lat: 22.4877590476567, //1
			lng: 120.5802983412830
			}  , {
			lat: 22.4877342650824, //S6
			lng: 120.5802708486420
			} , {
			lat: 22.4877207585750, //S5
			lng: 120.5802830526920
			} , {
			lat: 22.4877072520675, //S4
			lng: 120.5802952567430
			} , {
			lat: 22.4876937455601, //S3
			lng: 120.5803074607930
			} , {
			lat: 22.4876802390526, //S2
			lng: 120.5803196648440
			} , {
			lat: 22.4876667325452, //S1
			lng: 120.5803318688940
			} 
			];

			var factoryCircleNum = ['M20', 'M19', 'M18', 'M17', 'M16', 'M15', 'M14', 'M13', 'M12', 'M11', 'M10', 'M9', 'M8', 'M7', 'M6', 'M5', 'M4', 'M3', 'M2', 'M1', 'S6', 'S5', 'S4', 'S3', 'S2', 'S1'];
			var factoryCircle = [];
			var factoryCircleMarker = [];
			var factoryCircleInfowindow = [];
			positionCircleFactory.forEach(function(e, i) {
			 if  (i<=19)
			 {
				factoryCircle[i] = new google.maps.Circle({
				  center: e,
				  radius: 1.1,
				  strokeOpacity: 0,
				  fillColor: '#009393',
				  fillOpacity: 0.5,
				  map: map
				});
			 }
			 else
			 {
				factoryCircle[i] = new google.maps.Circle({
				  center: e,
				  radius: 0.9,
				  strokeOpacity: 0,
				  fillColor: '#005AB5',
				  fillOpacity: 0.5,
				  map: map
				});
			}
			
			factoryCircleMarker[i] = new google.maps.Marker({
			  position: e,
			  map: map,
			  icon: circleIcon,
			  label: {
				fontSize: "9pt",
				text: factoryCircleNum[i].toString()
			  }
			});
			factoryCircleInfowindow[i] = new google.maps.InfoWindow({
			  content: "<div id='divInfowindow'><h5>" + fishDatafactoryCircle[i]+ "</h5></div>" // 支援html
			});



			  factoryCircleMarker[i].addListener('click', e => {
				if ( prev_infowindow ) {
				   prev_infowindow.close();
				}
				prev_infowindow = factoryCircleInfowindow[i];
				factoryCircleInfowindow[i].open(this.map, factoryCircleMarker[i]);
			});

			});
/*
		function tableText(tableCell) {
		   alert(tableCell.innerHTML);
		}

		  */
		  
		}
		function changePositionFactory()
		{
			currentPage = "工廠";
			document.getElementById("factoryButton").className="btn btn-info active";
			document.getElementById("SDButton").className="btn btn-info ";
			document.getElementById("JKAButton").className="btn btn-info ";
			document.getElementById("JKBButton").className="btn btn-info ";
			
			document.getElementById("modifyID").innerHTML= "魚池編號";
			document.getElementById("modifyFishData").value= "";
			
			getSheetData("工廠");
			map.setCenter({  lat: 22.487805495806526, lng: 120.5802124740907  }); // 工廠定位
			map.setZoom(20);  // 工廠定位定位縮放
			
		}
		function changePositionSD()
		{
			currentPage = "SD";
			document.getElementById("factoryButton").className="btn btn-info ";
			document.getElementById("SDButton").className="btn btn-info active";
			document.getElementById("JKAButton").className="btn btn-info ";
			document.getElementById("JKBButton").className="btn btn-info ";
			
			document.getElementById("modifyID").innerHTML= "魚池編號";
			document.getElementById("modifyFishData").value= "";
			
			getSheetData("SD");
			map.setCenter({ lat: 22.48654928828763, lng: 120.57834320176198 }); 
			map.setZoom(17.8);  // SD定位縮放
		}
		function changePositionJKA()
		{
			currentPage = "A區";
			document.getElementById("factoryButton").className="btn btn-info ";
			document.getElementById("SDButton").className="btn btn-info ";
			document.getElementById("JKAButton").className="btn btn-info active";
			document.getElementById("JKBButton").className="btn btn-info ";
			
			document.getElementById("modifyID").innerHTML= "魚池編號";
			document.getElementById("modifyFishData").value= "";
			
			getSheetData("建功A", "溫室"); 
			map.setCenter({ lat: 22.47870410125927, lng:  120.56927710840841 }); // A區定位
			map.setZoom(18);  // A區定位定位縮放  18.5最好
		}
		function changePositionJKB()
		{
		
			currentPage = "B區";
			document.getElementById("factoryButton").className="btn btn-info ";
			document.getElementById("SDButton").className="btn btn-info ";
			document.getElementById("JKAButton").className="btn btn-info ";
			document.getElementById("JKBButton").className="btn btn-info active";
			
			document.getElementById("modifyID").innerHTML= "魚池編號";
			document.getElementById("modifyFishData").value= "";
			
			getSheetData("建功B");
			map.setCenter({ lat: 22.476415881334077, lng: 120.5690490942485 }); // B區定位
			map.setZoom(17);  // B區定位定位縮放  17.6最好
		}
		
		function modifySubmit()
		{
			$('#button1').attr('disabled', 'disabled');
			showSpinner();
			var modifyItemNum =  document.getElementById("modifyNum").value;
			var modifyItemId = document.getElementById("modifyID").innerHTML;
			var modifyItemFishData = document.getElementById("modifyFishData").value;
			if (modifyItemId == "魚池編號")
			{
				alert("請選擇魚池編號");
				$('#button1').removeAttr('disabled');
				hideSpinner();
				return false;
			}
			else
			{
				var confirmWindow = confirm('確定要修改【' + modifyItemId + '】' + "" + modifyItemFishData + "嗎？");
				if (confirmWindow) 
				{
					$.ajax({
				type: "post",
				url: "https://script.google.com/macros/s/AKfycbyI-GrN-OLNLklj96z4Q36Fvre9OXyfPdo_Yf7iQyfBVrm354kIjjqft3gF6MayWp10Pw/exec",
				data: {
						"modifyItemNum": modifyItemNum,
						"modifyItemId": modifyItemId,
						"modifyItemFishData": modifyItemFishData ,
				},
				success: function(response) {
				  if(response == "成功")
				  {
					/*alert("修改成功。");
					// 會重新取得Table資料，但地圖不會變
					if  (currentPage == "工廠")
					{
						changePositionFactory();
					}
					else if  (currentPage == "SD")
					{
						changePositionSD();
					}
					else if  (currentPage == "A區")
					{
						changePositionJKA();
					}
					else if  (currentPage == "B區")
					{
						changePositionJKB();
					}
					*/
					
					// window.location.reload(); reload會找不到原本定位而且表格會跑掉
					document.location.href= "sucess.html";
					 $('#button1').removeAttr('disabled');
					hideSpinner();
					
					 return;
				   }
				 },
				error: function(){
					alert("修改失敗！ 魚池編號：" + modifyItemId);
					$('#button1').removeAttr('disabled');
					hideSpinner();
					return;
					
				}
			});
				} 
				else 
				{
					$('#button1').removeAttr('disabled');
					hideSpinner();
					return false;
				}
			}
			
		}
		
		// Function to hide the Spinner
		function hideSpinner() {
			document.getElementById('spinner').style.display = 'none';
		} 
		// Function to show the Spinner
		function showSpinner() {
			document.getElementById('spinner').style.display = '';
		} 
	</script>
</head>
<body>


<div style="background-color:#ffffff; opacity: 0.5">
		<p style="margin:6px;">
			<font color="#000000" style="font-size:15pt"><CENTER>種魚管理系統 - 聖鯛水產科技</CENTER></font>
		</p>
		<p style="margin:12px;"></p>
</div>

<div class="container">

	<div id="map" >
	<!-- Async script executes immediately and must be after any DOM elements used in callback. -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDhI-bEG0jYoMtM4O15cuoaHk8cKIdTPlE&v=weekly"
      async
    ></script></div><!-- //&callback=initMap-->
	
	 <!--<div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups" style="margin-top:-30px" >-->
		<div class="btn-group btn-group-lg" role="group" style="margin-top:-34px" >
		  <button type="button" id="factoryButton" class="btn btn-info"  style="font-size:11pt;" onclick="changePositionFactory()">工廠</button>
		  <button type="button" id="SDButton"  class="btn btn-info"  style="font-size:11pt;"  onclick="changePositionSD()">ＳＤ</button>
		  <button type="button" id="JKAButton"  class="btn btn-info"  style="font-size:11pt;" onclick="changePositionJKA()">Ａ區</button>
		  <button type="button" id="JKBButton"  class="btn btn-info"  style="font-size:11pt;" onclick="changePositionJKB()">Ｂ區</button>
		</div>
	  
  <!--</div>-->
	<div style="height:250px;  position:relative; overflow:auto;margin-top:3px" >
	  <table class="table table-hover table-light" style="font-size:10pt;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;" id="tableID">
        <thead class="thead-dark">
          <tr id="header-row">
				<th data-field="num" style="width:20px; position: sticky;position: -webkit-sticky;
position: -moz-sticky; position: -o-sticky; position: -ms-sticky; position: sticky; top: 0;display:none" >
              <span >
                #
              </span>
            </th>
            <th data-field="id" style="width:80px; position: sticky;position: -webkit-sticky;
position: -moz-sticky; position: -o-sticky; position: -ms-sticky; position: sticky; top: 0;">
              <span >
                魚池編號
              </span>
            </th>
            <th data-field="name" style="position: sticky;position: -webkit-sticky;
position: -moz-sticky; position: -o-sticky; position: -ms-sticky; position: sticky;   top: 0;">
              <span>
                種魚資料
              </span>
            </th>
            <th data-field="date" style="width:140px; position: sticky;position: -webkit-sticky;
position: -moz-sticky; position: -o-sticky; position: -ms-sticky; position: sticky; top: 0;">
              <span>
                更新日期
              </span>
            </th>
          </tr>
        </thead>
      </table>
	  </div>
	  <div  style="margin-top:3px" class="input-group input-group-lg input-group">
			<div class="input-group-prepend">
			<span class="input-group-text" id="modifyID" style="font-size:11pt;width:80px;”text-align: center; display:block;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;" >魚池編號</span>
			</div>
			<input type="text" style="font-size:11pt;display:none"  id="modifyNum" >
			<input type="text" class="form-control" style="font-size:11pt;"  id="modifyFishData">
			<div class="input-group-append">
			<button class="btn btn-secondary" type="button" style="font-size:11pt;" onclick="javascript:modifySubmit()" id="button1">修改</button>
			</div>
		</div>
	  </div>
	  
	  
	</div>
	
</div><!-- /.container -->
	
		<div class="text-center" style="height:100%; width:100%; top: 0 ;position:absolute; background-color:#ffffff; opacity: 0.4;" id="spinner">
			<div class="spinner-border" style="position:absolute; top:50%; margin-top: 0 ; width: 5rem; height: 5rem;" role="status">
			  <span class="visually-hidden"></span>
			</div>
		</div>
</div>
</body>
</html>