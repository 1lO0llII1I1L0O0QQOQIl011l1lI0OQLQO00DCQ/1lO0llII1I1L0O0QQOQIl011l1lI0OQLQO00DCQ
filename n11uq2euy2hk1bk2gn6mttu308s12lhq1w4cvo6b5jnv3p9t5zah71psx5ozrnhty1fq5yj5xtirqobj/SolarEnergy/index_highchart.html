<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
	
	 <!-- icon -->
	 <link rel="shortcut icon" href="image/32x32.ico">
	 <link rel="icon" type="image/png" href="image/192x192.png" sizes="192x192">
	 <link rel="apple-touch-icon" sizes="120x120" href="image/120x120.png">
	 <link rel="apple-touch-icon" sizes="152x152" href="image/152x152.png">
	 <link rel="apple-touch-icon" sizes="180x180" href="image/180x180.png">

    <title>聖鯛 - 綠電儲能系統</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">
    <script src="HighCharts7/code/highcharts.js"></script>
    <script src="HighCharts7/code/modules/exporting.js"></script>
    <script src="HighCharts7/code/modules/variwide.js"></script>
	<script>
	/*
	function GetShowPC() {
	return ( $('.townBody #PC_week .report-table.pc').is(':hidden') ) ? false : true;
	}
	*/
	
	var CbChart3hr = function () {
	/*
	// 2022.12.22 72hr
	ShowPC = GetShowPC();
	if ( ShowPC ) {
		ChartLabelAlign = 'center';
	} else {
		ChartLabelAlign = 'left';
	}
	*/
	$('#div_chart .chart-md-scroll').css({'width':'991px'});
	
	Data3hr = TempArray_3hr;
	
	var TempSeries = {
		"DataType":"h3",
		"X":Time_3hr,
		"T":{
			"C":Data3hr[TID].C.T,
			"F":Data3hr[TID].F.T
		},
		"AT":{
			"C":Data3hr[TID].C.AT,
			"F":Data3hr[TID].F.AT
		},
		"Icon":Data3hr[TID].Wx[VER]
	};
	
	//console.log(TempSeries)
	
	plotHighcharts_hr('ChartId3hr', TempSeries);
};
	
	function plotHighcharts_hr(ChartTarget, TempSeries) {
	TempUnit = getTempUnit();
	
	$('#'+ChartTarget).html('');
	
	//var DivW = $('#chart_tem').width();
	var MyMaxPadding, LineHR;
	var FromHR, ToHR = 0;
	var MyPlotLines = [];
	var MyPlotBands = [];
	var DateLineWidth = 1;
	var DateLineZindex = 2;
	var DateLineColor = '#cccccc';
	var NightBandColor = '#f9f9f9';
	var Visibility = {'T':true,'AT':true};
	var DoRedraw = false;
	
	switch(TempSeries.DataType){
		case 'h3':  
			//MyMaxPadding = 0.3;
			MyMaxPadding = 0.5;
			
			FromHR = ( 15 - parseInt(TempSeries.X[0].substr(0,2)) ) / 3 + 0.5;
			if ( ( FromHR === 4.5 )||( FromHR === 5.5 ) ) FromHR -= 8;
			
			// 2022.12.22 72hr 16.5 -> 24.5
			while ( ( FromHR < 24.5 )&&( ToHR < 24.5 ) ) {
				ToHR = FromHR + 4;
				if ( ToHR > 24.5 ) ToHR = 24.5;
				
				MyPlotBands.push({
					color: NightBandColor,
					from: FromHR,
					to: ToHR
				});
				
				LineHR = FromHR + 2;
				
				MyPlotLines.push({
					color: DateLineColor,
					width: DateLineWidth,
					value: LineHR,
					zIndex: DateLineZindex
				});
				
				FromHR += 8;
			}
			break;
			
		case 'h24':
			MyMaxPadding = 0;
			
			FromHR = ( 17 - parseInt(TempSeries.X[0].substr(0,2)) ) + 0.5;
			if( ( FromHR >= 12.5 )&&( FromHR <= 17.5 ) ) FromHR -= 24;
			
			while ( ( FromHR < 23.5 )&&( ToHR < 23.5 ) ) {
				ToHR = FromHR + 12;
				if ( ToHR > 23.5 ) ToHR = 23.5;
				
				MyPlotBands.push({
					color: NightBandColor,
					from: FromHR,
					to: ToHR
				});
				
				LineHR = FromHR + 6;
				
				MyPlotLines.push({
					color: DateLineColor,
					width: DateLineWidth,
					value: LineHR,
					zIndex: DateLineZindex
				});
				
				FromHR += 24;
			}
			break;
			
		default: break;
	}
	
	//console.log(MyPlotBands)
	
	Highcharts.chart(ChartTarget, {
		chart: {
			type: 'spline',
			height: 400,
			style: {
				fontSize: '1em'
			},
			events: {
				redraw: function () {
					if( ( TempSeries.DataType === "h3" )&&( DoRedraw === true ) ){
						DoRedraw = false;
						//console.log('Redraw...');
						//console.log(Visibility);
						
						if( Visibility.T !== Visibility.AT ){
							switch(true){
								case ( Visibility.T  === true ): var MySeries = this.series[0].data; break;
								case ( Visibility.AT === true ): var MySeries = this.series[1].data; break;
								default: break;
							}
							
							Highcharts.each(MySeries, function(point, i){
								var Pt  = MySeries[i];
								var MyH = parseInt(Pt.category.substr(0,2));
								var DN = ( ( MyH >= 6 )&&( MyH < 18 ) ) ? 'day' : 'night';
								var MyImage = '/V8/assets/img/weather_icons/weathers/svg_icon/'+DN+'/'+TempSeries.Icon[i][0]+'.svg';
								
								point.update({
									dataLabels: {
										//enabled: true,
										useHTML: true,
										format: '<div style="text-align:center;margin-bottom:10px;"><img alt="'+TempSeries.Icon[i][1]+'" src="'+MyImage+'" style="width:25px" /><br><span>'+Pt.y+'</span></div>'
									}
								});
							});
						}else{
							if( ( Visibility.T === true )&&( Visibility.AT === true ) ){
								var MySeries1 = this.series[0].data;
								var MySeries2 = this.series[1].data;
								
								Highcharts.each(MySeries1, function(point, i){
									var Pt  = MySeries1[i];
									var Pat = MySeries2[i];
									
									if ( Pat.plotY >= Pt.plotY ) {
										if ( TempSeries.DataType === "h3" ) {
											var MyH = parseInt(Pt.category.substr(0,2));
											var DN = ( ( MyH >= 6 )&&( MyH < 18 ) ) ? 'day' : 'night';
											var MyImage = '/V8/assets/img/weather_icons/weathers/svg_icon/'+DN+'/'+TempSeries.Icon[i][0]+'.svg';
											
											point.update({
												dataLabels: {
													//enabled: true,
													useHTML: true,
													format: '<div style="text-align:center;margin-bottom:10px;"><img alt="'+TempSeries.Icon[i][1]+'" src="'+MyImage+'" style="width:25px" /><br><span>'+Pt.y+'</span></div>'
												}
											});
										}
									} else {
										point.update({
											dataLabels: {
												verticalAlign:'top' // 銝𧢲�埝𤩅蝺𡁏�嗵惜摮烾�牐�𧢲䲮
											}
										});
									}
								});
								
								Highcharts.each(MySeries2, function(point, i){
									var Pt  = MySeries1[i];
									var Pat = MySeries2[i];
									
									if ( Pt.plotY >= Pat.plotY ) {
										if ( TempSeries.DataType === "h3" ) {
											var MyH = parseInt(Pat.category.substr(0,2));
											var DN = ( ( MyH >= 6 )&&( MyH < 18 ) ) ? 'day' : 'night';
											var MyImage = '/V8/assets/img/weather_icons/weathers/svg_icon/'+DN+'/'+TempSeries.Icon[i][0]+'.svg';
											
											point.update({
												dataLabels: {
													//enabled: true,
													useHTML: true,
													format: '<div style="text-align:center;margin-bottom:10px;"><img alt="'+TempSeries.Icon[i][1]+'" src="'+MyImage+'" style="width:25px" /><br><span>'+Pat.y+'</span></div>'
												}
											});
										}
									} else {
										point.update({
											dataLabels: {
												verticalAlign:'top' // 銝𧢲�埝𤩅蝺𡁏�嗵惜摮烾�牐�𧢲䲮
											}
										});
									}
								});
							}
						}
					}
				}
			}
		},
		title: {
			align: ChartLabelAlign,
			text: MyTownName[VER],
			style: {
				fontSize: '0.8em'
			}
		},
		subtitle: {
			text: '',
			style: {
				fontSize: '0.8em'
			}
		},
		xAxis: {
			categories: TempSeries.X,
			labels: {
				autoRotation: false,
				style: {
					fontSize: '0.8em'
				},
				formatter: function(){
					var ShowDate = false;
					var MyHR = this.value.substr(0,2);
					if( ( MyHR === '00' )||(( this.pos === 0 )&&( parseInt(MyHR) < 21 )) ) ShowDate = true;
					
					if( ShowDate ){
						var MyDD = this.value.substr(3,5);
						//var MyMM = this.value.substr(3,2);
						//var MyDD = this.value.substr(6,2);
						
						return MyHR + '<br><b style="color:#1a67b1">' + MyDD + '</b>';
						/*if( DivW > 900 ){
							return MyHR + '<br><b style="color:#1a67b1">' + MyMM + '/' + MyDD + '</b>';
						}else{
							return MyHR + '<br><b style="color:#1a67b1">' + MyMM + '/</b><br><b style="color:#1a67b1">' + MyDD + '</b>';
						}*/
					}else{
						return MyHR;
					}
				}
			},
			plotLines: MyPlotLines,// ��𥟇𠯫蝺�
			plotBands: MyPlotBands // 憭𨀣�𡁏�畾萎�羓�啗𠧧�峕艶
		},
		yAxis: {
			title: {
				text: MyString.T[VER] + '嚗��'+TempUnit+'嚗�',
				style: {
					fontSize: '0.8em'
				}
			},
			labels: {
				style: {
					fontSize: '0.8em'
				}
			},
			maxPadding: MyMaxPadding // �俈甇Ｗ予瘞� icon 頞��枂銝𢠃�羓��
		},
		legend: {
			align: ChartLabelAlign,
			itemStyle: {
				fontSize: '0.8em'
			}
		},
		tooltip: {
			//headerFormat: '<span style="font-size:1em;font-weight:bolder;">{point.key}</span><br>',
			//valueSuffix: '簞',
			borderColor: '#000000',
			borderRadius: 0,
			crosshairs: true,
			padding: 0,
			shared: true,
			useHTML: true,
			style: {
				fontSize: '0.8em'
			},
			formatter: function(){
				//console.log(this);
				
				var MyWx = '';
				var MyRow = '';
				var MyLabel = '';
				var MyColor = '';
				var MyPointIndex, Pt, Ct;
				
				var MyH = this.x.substr(0,2);
				var MyD = this.x.substr(3,5);
				
				if ( TempSeries.DataType === "h3" ) {
					try {
						typeof this.points[0].point.index;
						MyPointIndex = this.points[0].point.index;
						MyWx = '<span>��� '+MyString.Wx[VER]+': <span style="font-weight:bolder;">'+TempSeries.Icon[MyPointIndex][1]+'</span><br>';
					} catch (e) {
						MyWx = '';
					}
				}
				
				for(i=0; i<this.points.length; i++){
					var MyIdx = this.points[i].colorIndex;
					switch(MyIdx){
						case 0:
							MyLabel = MyString.T[VER];
							MyColor = MyString.tempChart_ex.hr.Color1;
							break;
						case 1:
							MyLabel = MyString.AT[VER];
							MyColor = MyString.tempChart_ex.hr.Color2;
							break;
						default: break;
					}
					
					if( ( i === 0 )&&( MyIdx === 1 ) ) MyIdx = 0;
					
					try { typeof this.points[MyIdx].y; Pt = this.points[MyIdx].y; } catch (e) { Pt = '-'; }
					try { typeof this.points[MyIdx].color; Ct = this.points[MyIdx].color; } catch (e) { Ct = MyColor; }
					
					MyRow += '<span><span style="color:'+Ct+';">���</span> '+MyLabel+': <span style="font-weight:bolder;">'+Pt+' 簞'+TempUnit+'</span></span><br>';
				}
				
				var Pobj = ''+
					//'<div style="position:relative;top:1px;left:1px;padding:10px;border:1px solid #000000;border-bottom:2px solid #000000;background-color:rgba(255,255,255,0.75);">'+
					'<div style="position:relative;padding:10px;border-top:1px solid #000000;border-left:1px solid #000000;background-color:rgba(255,255,255,0.75);">'+
						'<span style="font-size:1em;font-weight:bolder;">'+MyD+' '+MyH+':00</span><br>'+
						MyWx+
						MyRow+
					'</div>';
				
				return Pobj;
			}
		},
		series: [{
			name: MyString.T[VER] + ' (簞' + TempUnit + ')',
			data: TempSeries.T[TempUnit]
		}, {
			name: MyString.AT[VER] + ' (簞' + TempUnit + ')',
			data: TempSeries.AT[TempUnit]
		}],
		colors: [MyString.tempChart_ex.hr.Color1, MyString.tempChart_ex.hr.Color2],
		plotOptions: {
			series: {
				connectNulls: true,
				events: {
					legendItemClick: function () {
						//console.log(this.visible);
						//console.log(this.index);
						switch(this.index){
							case 0: Visibility.T = !this.visible; break;
							case 1: Visibility.AT = !this.visible; break;
							default: break;
						}
						DoRedraw = true;
					}
				}
			},
			spline: {
				dataLabels: {
					allowOverlap: true, // 撘瑕��𤩅蝺𡁜�碶�羓��彍摮烾＊蝷綽���𡝗���滨�𡃏䌊��閖黸��誩�蠘��
					enabled: true,
					color: '#555',
					style: {
						fontSize: '0.8em'
					}
				},
				// enableMouseTracking: false
			}
		},
		navigation: {
			buttonOptions: {
				enabled: false
			}
		},
		exporting: {
			enabled: false
		},
		credits: {
			text: MyString.Copyright[VER],
			href: 'javascript:void(0)',
			style: {
				fontSize: '0.8em'
			}
		}
	}, function (chart) {
		/*for ( i=0; i<chart.series[0].data.length; i++ ) {
			//console.log(chart.series[0].data[i]);
			var Pt  = chart.series[0].data[i];
			var Pat = chart.series[1].data[i];
			var MyPlotY = ( Pt.plotY >= Pat.plotY ) ? Pat.plotY : Pt.plotY;
			var MyH = parseInt(Pt.category.substr(0,2));
			var DN = ( ( MyH >= 6 )&&( MyH < 18 ) ) ? 'day' : 'night';
			
			chart.renderer.image(
				'/V8/assets/img/weather_icons/weathers/svg_icon/'+DN+'/'+TempSeries.Icon[i][0]+'.svg',
				Pt.plotX+chart.plotLeft-13, 
				MyPlotY+chart.plotTop-50,
				25,
				25
			).add();
		}*/
		
		Highcharts.each(chart.series[0].data, function(point, i){
			var Pt  = chart.series[0].data[i];
			var Pat = chart.series[1].data[i];
			
			if ( Pat.plotY >= Pt.plotY ) {
				if ( TempSeries.DataType === "h3" ) {
					var MyH = parseInt(Pt.category.substr(0,2));
					var DN = ( ( MyH >= 6 )&&( MyH < 18 ) ) ? 'day' : 'night';
					var MyImage = '/V8/assets/img/weather_icons/weathers/svg_icon/'+DN+'/'+TempSeries.Icon[i][0]+'.svg';
					
					point.update({
						dataLabels: {
							//enabled: true,
							useHTML: true,
							format: '<div style="text-align:center;margin-bottom:10px;"><img alt="'+TempSeries.Icon[i][1]+'" src="'+MyImage+'" style="width:25px" /><br><span>'+Pt.y+'</span></div>'
						}
					});
				}
			} else {
				point.update({
					dataLabels: {
						verticalAlign:'top' // 銝𧢲�埝𤩅蝺𡁏�嗵惜摮烾�牐�𧢲䲮
					}
				});
			}
		});
		
		Highcharts.each(chart.series[1].data, function(point, i){
			var Pt  = chart.series[0].data[i];
			var Pat = chart.series[1].data[i];
			
			if ( Pt.plotY >= Pat.plotY ) {
				if ( TempSeries.DataType === "h3" ) {
					var MyH = parseInt(Pat.category.substr(0,2));
					var DN = ( ( MyH >= 6 )&&( MyH < 18 ) ) ? 'day' : 'night';
					var MyImage = '/V8/assets/img/weather_icons/weathers/svg_icon/'+DN+'/'+TempSeries.Icon[i][0]+'.svg';
					
					point.update({
						dataLabels: {
							//enabled: true,
							useHTML: true,
							format: '<div style="text-align:center;margin-bottom:10px;"><img alt="'+TempSeries.Icon[i][1]+'" src="'+MyImage+'" style="width:25px" /><br><span>'+Pat.y+'</span></div>'
						}
					});
				}
			} else {
				point.update({
					dataLabels: {
						verticalAlign:'top' // 銝𧢲�埝𤩅蝺𡁏�嗵惜摮烾�牐�𧢲䲮
					}
				});
			}
		});
	});
}
	</script>

</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-fish" style='font-size:24px'></i> <i class="fas fa-sun" style='font-size:24px'></i>
                </div>
                <div class="sidebar-brand-text mx-3">SDAT 聖鯛</div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>
<!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Data
            </div>

            <!-- Nav Item - Charts -->
            <li class="nav-item">
                <a class="nav-link" href="charts.html">
                    <i class="fas fa-fw fa-chart-area"></i>
                    <span>Charts</span></a>
            </li>

            <!-- Nav Item - Tables -->
            <li class="nav-item">
                <a class="nav-link" href="tables.html">
                    <i class="fas fa-fw fa-table"></i>
                    <span>Tables</span></a>
            </li>

            <!-- Divider -->
			
            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Others
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="fas fa-fw fa-cog"></i>
                    <span>Components</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Custom Components:</h6>
                        <a class="collapse-item" href="buttons.html">Buttons</a>
                        <a class="collapse-item" href="cards.html">Cards</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                    aria-expanded="true" aria-controls="collapseUtilities">
                    <i class="fas fa-fw fa-wrench"></i>
                    <span>Utilities</span>
                </a>
                <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Custom Utilities:</h6>
                        <a class="collapse-item" href="utilities-color.html">Colors</a>
                        <a class="collapse-item" href="utilities-border.html">Borders</a>
                        <a class="collapse-item" href="utilities-animation.html">Animations</a>
                        <a class="collapse-item" href="utilities-other.html">Other</a>
                    </div>
                </div>
            </li>

            
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>

                    <!-- Topbar Search -->
                    <form
                        class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                        <div class="input-group">
								
								<h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
								 
                        </div>
                    </form>

                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                        <!-- Nav Item - Search Dropdown (Visible Only XS) -->
                        <li class="nav-item dropdown no-arrow d-sm-none">
                            
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                                aria-labelledby="searchDropdown">
                                <form class="form-inline mr-auto w-100 navbar-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control bg-light border-0 small"
                                            placeholder="Search for..." aria-label="Search"
                                            aria-describedby="basic-addon2">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary" type="button">
                                                <i class="fas fa-search fa-sm"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </li>

                        <!-- Nav Item - Alerts -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-bell fa-fw"></i>
                                <!-- Counter - Alerts -->
                                <span class="badge badge-success badge-counter">0</span>
                            </a>
                            <!-- Dropdown - Alerts -->
							<!--
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="alertsDropdown">
                                <h6 class="dropdown-header">
                                    Alerts Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-primary">
                                            <i class="fas fa-file-alt text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 12, 2019</div>
                                        <span class="font-weight-bold">A new monthly report is ready to download!</span>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-success">
                                            <i class="fas fa-donate text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 7, 2019</div>
                                        $290.29 has been deposited into your account!
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-warning">
                                            <i class="fas fa-exclamation-triangle text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 2, 2019</div>
                                        Spending Alert: We've noticed unusually high spending for your account.
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                            </div>
							-->
                        </li>

                        <!-- Nav Item - Messages -->
						<!--
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-envelope fa-fw"></i>
                                <span class="badge badge-danger badge-counter">0</span>
                            </a>
						
                            <!-- Dropdown - Messages -->
							<!--
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="messagesDropdown">
                                <h6 class="dropdown-header">
                                    Message Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_1.svg"
                                            alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div class="font-weight-bold">
                                        <div class="text-truncate">Hi there! I am wondering if you can help me with a
                                            problem I've been having.</div>
                                        <div class="small text-gray-500">Emily Fowler · 58m</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_2.svg"
                                            alt="...">
                                        <div class="status-indicator"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">I have the photos that you ordered last month, how
                                            would you like them sent to you?</div>
                                        <div class="small text-gray-500">Jae Chun · 1d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_3.svg"
                                            alt="...">
                                        <div class="status-indicator bg-warning"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">Last month's report looks great, I am very happy with
                                            the progress so far, keep up the good work!</div>
                                        <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="https://source.unsplash.com/Mv9hjnEUHR4/60x60"
                                            alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">Am I a good boy? The reason I ask is because someone
                                            told me that people say this to all dogs, even if they aren't good...</div>
                                        <div class="small text-gray-500">Chicken the Dog · 2w</div>
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Read More Messages</a>
								
                            </div>
							-->
                        </li>

                        <div class="topbar-divider d-none d-sm-block"></div>

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small">Momo Yan</span>
                                <div class="sidebar-brand-icon">
									<i class="fas fa-user-circle"></i>
								</div>
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="userDropdown">
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Profile
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Settings
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Activity Log
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Logout
                                </a>
                            </div>
                        </li>

                    </ul>

                </nav>
                <!-- End of Topbar -->
				<!-- End of Page Same-->
				
                <!-- Begin Page Content -->
				
				
				<!--charts-->
				<div accesskey="T" title="鄉鎮預報曲線圖" id="div_chart">
				<!--
					<h3 id="tab_chart" class="heading-title type_7">
						<a href="javascript:void(0)" class="anchor tab_hr active" id="Tab_3hr" data-tab="3hr" title="逐三小時溫度曲線" data-gtmtitle="鄉鎮預報_天氣資訊_逐三小時溫度曲線圖">
							<i class="icon-3hr" aria-hidden="true"></i>
							<span>逐三小時<br class="hidden visible-xs">預報</span>
						</a>
						<a href="javascript:void(0)" class="anchor tab_hr" id="Tab_weeks" data-tab="weeks" title="一週溫度曲線" data-gtmtitle="鄉鎮預報_天氣資訊_一週溫度曲線圖">
							<i class="icon-weekTemperature" aria-hidden="true"></i>
							<span>一週<br class="hidden visible-xs">溫度曲線</span>
						</a>
						<a href="javascript:void(0)" class="anchor tab_hr" id="Tab_body" data-tab="weeks_at" title="一週體感溫度曲線" data-gtmtitle="鄉鎮預報_天氣資訊_一週體感溫度曲線圖">
							<i class="icon-bodyTemperature" aria-hidden="true"></i>
							<span>一週體感<br class="hidden visible-xs">溫度曲線</span>
						</a>
						<a href="javascript:void(0)" class="anchor tab_hr" id="Tab_24hr" data-tab="24hr" title="過去24小時溫度曲線" data-gtmtitle="鄉鎮預報_天氣資訊_過去24小時溫度曲線圖">
							<i class="icon-24hr" aria-hidden="true"></i>
							<span>過去<br class="hidden visible-xs">24小時</span>
						</a>
					</h3>
				-->
					<div class="tempChart_ex visible-xs">
						<ul>
							<li class="ttem-C">溫度</li>
							<li class="ttem-C">體感溫度</li>
							<li class="ttem-C d-none">高溫</li>
							<li class="ttem-C d-none">低溫</li>
						</ul>
					</div>
					<div class="table-responsive">
						<div class="chart-md-scroll">
							<div id="chart_tem" style="min-width: 280px; margin: 0 auto">
								<div id="ChartId3hr" class=""></div>
								<div id="ChartIdweeks" class="d-none"></div>
								<div id="ChartIdweeksbody" class="d-none"></div>
								<div id="ChartId24hr" class="d-none"></div>
							</div>
						</div>
					</div>
				</div>
                <!--end charts-->
				
				
				
				
                <div class="container-fluid" id="containerID" style="display:none;visibility:hidden;">
					
					<!-- Content Row -->
                    <div class="row">

                        <!-- Content Column -->
                        <div class="col-lg-6 mb-4">

                            <!-- Data Card Example -->
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">電池資訊</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="font-weight-bold text-dark">SOC <span
                                            class="float-right" id="socSpanID">(120/400)</span></h4>
                                    <div class="progress mb-4">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" 
											role="progressbar" style="width: 30%" aria-valuenow="30" 
                                            aria-valuemin="0" aria-valuemax="100" id="socProgressID">30%</div>
											
                                    </div>
									
									<h4 class="small font-weight-bold text-dark">時間<span
                                            class="float-right" id="timeSpanID">2024/01/20 19:22</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">總電壓<span
                                            class="float-right" id="voltSpanID">540 V</span></h4>
                                    
                                    <h4 class="small font-weight-bold text-dark">總電流<span
                                            class="float-right text-danger" id="currentlySpanID">放電 12 A</span></h4>
	                                <h4 class="small font-weight-bold text-dark">剩餘容量<span
                                            class="float-right" id="capacitySpanID">120 AH</span></h4>								
									<h4 class="small font-weight-bold text-dark" >單體電壓
										<span class="float-right row"  style="width:80%">
												<span class="col bg-danger text-white text-center " id="maxVoltSpanID">
												  3316 V
												</span>
												<span class="col bg-warning text-white text-center " id="avgVoltSpanID">
												  3311 V
												</span>
												<span class="col  bg-success text-white text-center " id="minVoltSpanID">
												  3306 V
												</span>
												
										</span>
									</h4>	
                                    <h4 class="small font-weight-bold text-dark" >單體溫度
										<span class="float-right row" style="width:80%">
												<span class="col bg-danger text-white text-center " id="maxTempSpanID">
												  25 ℃
												</span>
												<span class="col bg-warning text-white text-center " id="avgTempSpanID">
												  23 ℃
												</span>
												<span class="col  bg-success text-white text-center " id="minTempSpanID">
												  22 ℃
												</span>
												
										</span>
									</h4>	
                                    <h4 class="small font-weight-bold text-dark">在線簇數<span
                                            class="float-right" id="olineNumSpanID">4 簇</span></h4>
									<h4 class="small font-weight-bold text-dark">在線電芯數<span
                                            class="float-right" id="cellNumSpanID">640 串</span></h4>
									<h4 class="small font-weight-bold text-dark">在線溫感數<span
                                            class="float-right" id="tempNumSpanID">240 串</span></h4>
                                    
                                </div>
                            </div>

                            
                        </div>

                        <div class="col-lg-6 mb-4">
                            <!-- MPPT -->
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">MPPT & PCS 資訊</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small font-weight-bold text-dark">
									<button type="button" class="btn btn-sm btn-success " id="MPPTSWID" disabled>MPPT 開啟</button>
									<span class="float-right" id="socSpanID">
										<button type="button" class="btn btn-sm btn-success" id="MPPTFlagID" disabled>正常運作</button>
									</span>
									</h4>
											
									
                                    <h4 class="small font-weight-bold text-dark">高壓側電壓
										<span class="float-right" id="MPPTvoltHSpanID">6621 V</span></h4>
                                    
                                    <h4 class="small font-weight-bold text-dark">低壓側電壓
										<span class="float-right" id="MPPTvoltLSpanID">1 V</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">低壓側電流<span
                                            class="float-right text-danger" id="MPPTCurrentlyLSpanID">0 A</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">低壓側功率<span
                                            class="float-right" id="MPPTPowerSpanID">0 kW</span></h4>
									
									<!-- PCS -->
									<h4 class="small font-weight-bold text-dark">
									<button type="button" class="btn btn-sm btn-success" id="PCSSWID" disabled>PCS 開啟 - 狀態 9</button>
									<span class="float-right" id="socSpanID">
										<button type="button" class="btn btn-sm btn-success" id="PCSFlagID" disabled>正常運作</button>
										<!--<button type="button" class="btn btn-sm btn-danger" id="MPPTFlagID" disabled>異常故障</button>-->
									</span>
									</h4>
									<h4 class="small font-weight-bold text-dark">DC端電壓<span
                                            class="float-right" id="PCSDCVoltSpanID">662 V</span></h4>
                                    
                                    <h4 class="small font-weight-bold text-dark">DC輸出功率<span
                                            class="float-right" id="PCSDCPowerSpanID">62 kW</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">DC輸出電流<span
                                            class="float-right"  id="PCSDCCurrentSpanID">95 A</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">AC輸出有效功率<span
                                            class="float-right"  id="PCSACPowerSpanID">50 kW</span></h4>
									<h4 class="small font-weight-bold text-dark">AC輸出無效功率<span
									class="float-right" id="PCSACVarSpanID">0 kW</span></h4>

											
                                </div>
                            </div>

                        </div>
                    </div>
                    
					

                </div>
                <!-- /.container-fluid -->
				<div class="d-flex justify-content-center" id="loading">
					  <div class="spinner-border" role="status">
						<span class="visually-hidden;"></span>
					  </div>
				</div>
            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; 聖鯛水產科技有限公司 2024</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="vendor/chart.js/Chart.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="js/demo/chart-area-demo.js"></script>
    <!--<script src="js/demo/chart-pie-demo.js"></script>-->
	
	<script>
		getData();
		async function getData() {
		
			//today https://github.com/gavinpwd/weather-app/blob/master/js/index.js
			
			// Call 5 day / 3 hour forecast data https://openweathermap.org/forecast5 
			//https://api.openweathermap.org/data/2.5/forecast?lat=22.4787359&lon=120.5659494&appid=ea102967bfa542930faa56f6bc4a34c7
			
			document.getElementById('loading').style = "";
			document.getElementById('containerID').style = "display:none; visibility:hidden";
			
			const uri = 'https://script.google.com/macros/s/AKfycbxBBcV0F-4PnNflg3zytsgs1keVYYrkoOKxsQfos4l3mAluSxx1sjGvw8ymw7iObKgWTg/exec?date=dashboard';
			const response = await fetch(uri);
			const data = await response.json();
			var item = data[0];
			
			var socSpanID = document.getElementById('socSpanID');
			socSpanID.textContent ='(' + item.capacity + '/400)'; 
			var socProgressID = document.getElementById('socProgressID');
			socProgressID.textContent = item.soc + '%';
			socProgressID.style.width = item.soc + '%';
			//error socProgressIDEle.attr('aria-valuenow', '60');
			var timeSpanID = document.getElementById('timeSpanID');
			timeSpanID.textContent = item.time;
			var voltSpanID = document.getElementById('voltSpanID');
			voltSpanID.textContent = item.volt + ' V';
			var currentlySpanID = document.getElementById('currentlySpanID');
			if (item.currently > 0)
			{
				currentlySpanID.textContent = '充電 '  + item.currently + ' A';
			}
			else
			{
				currentlySpanID.textContent = '放電 '  + item.currently + ' A';
			}
			
			var capacitySpanID = document.getElementById('capacitySpanID');
			capacitySpanID.textContent = item.capacity + ' AH';
			
			var olineNumSpanID =  document.getElementById('olineNumSpanID');
			olineNumSpanID.textContent = item.OlineNum + ' 簇';
			
			var cellNumSpanID =  document.getElementById('cellNumSpanID');
			cellNumSpanID.textContent = item.CellNum + ' 串';
			
			var tempNumSpanID =  document.getElementById('tempNumSpanID');
			tempNumSpanID.textContent = item.TempNum + ' 串';
			
			var avgTempSpanID =  document.getElementById('avgTempSpanID');
			avgTempSpanID.textContent = item.avgTemp + ' ℃';
			
			var maxTempSpanID =  document.getElementById('maxTempSpanID');
			maxTempSpanID.textContent = item.MaxTemp + ' ℃';
			
			var minTempSpanID =  document.getElementById('minTempSpanID');
			minTempSpanID.textContent = item.MinTemp + ' ℃';
			
			var avgVoltSpanID =  document.getElementById('avgVoltSpanID');
			avgVoltSpanID.textContent = item.avgVolt + '';
			
			var maxVoltSpanID =  document.getElementById('maxVoltSpanID');
			maxVoltSpanID.textContent = item.MaxVolt + '';
			
			var minVoltSpanID =  document.getElementById('minVoltSpanID');
			minVoltSpanID.textContent = item.MinVolt + '';
			
			var MPPTSWID =  document.getElementById('MPPTSWID');
			
			if (item.MPPT1_Sw == true)
			{
				MPPTSWID.className = "btn btn-sm btn-success ";
				MPPTSWID.textContent = 'MPPT 開啟';
			}
			else
			{
				MPPTSWID.className = "btn btn-sm btn-danger ";
				MPPTSWID.textContent = 'MPPT 關閉';
			}
			
			var MPPTFlagID =  document.getElementById('MPPTFlagID');
			
			if (item.failFlagMPPT == '正常')
			{
				MPPTFlagID.className = "btn btn-sm btn-success ";
				MPPTFlagID.textContent = '正常運作';
			}
			else
			{
				MPPTFlagID.className = "btn btn-sm btn-danger ";
				MPPTFlagID.textContent = '異常故障';
			}
			
			
			var MPPTvoltHSpanID =  document.getElementById('MPPTvoltHSpanID');
			MPPTvoltHSpanID.textContent = item.MPPT1Volt_H + ' V';
			
			var MPPTvoltLSpanID =  document.getElementById('MPPTvoltLSpanID');
			MPPTvoltLSpanID.textContent = item.MPPT1Volt_L + ' V';
			
			var MPPTCurrentlyLSpanID =  document.getElementById('MPPTCurrentlyLSpanID');
			MPPTCurrentlyLSpanID.textContent = item.MPPT1Currently_L + ' A';

			var MPPTPowerSpanID =  document.getElementById('MPPTPowerSpanID');
			MPPTPowerSpanID.textContent = item.MPPT1Power_L + ' kW';


			var PCSSWID =  document.getElementById('PCSSWID');
			
			if (item.PCS_Sw == true)
			{
				PCSSWID.className = "btn btn-sm btn-success ";
				PCSSWID.textContent = 'PCS 開啟 - 狀態 ' + item.PCS_Status;
			}
			else
			{
				PCSSWID.className = "btn btn-sm btn-danger ";
				PCSSWID.textContent = 'PCS 關閉 - 狀態 ' + item.PCS_Status;
			}
			
			var PCSFlagID =  document.getElementById('PCSFlagID');
			
			if (item.failFlagPcs == '正常')
			{
				PCSFlagID.className = "btn btn-sm btn-success ";
				PCSFlagID.textContent = '正常運作';
			}
			else
			{
				PCSFlagID.className = "btn btn-sm btn-danger ";
				PCSFlagID.textContent = '異常故障';
			}

			var PCSDCVoltSpanID =  document.getElementById('PCSDCVoltSpanID');
			PCSDCVoltSpanID.textContent = item.PCSDC_Volt + ' V';

			var PCSDCPowerSpanID =  document.getElementById('PCSDCPowerSpanID');
			PCSDCPowerSpanID.textContent = item.PCSDC_Power + ' kW';

			var PCSDCCurrentSpanID =  document.getElementById('PCSDCCurrentSpanID');
			PCSDCCurrentSpanID.textContent = item.PCSDC_Currently + ' A';

			var PCSACPowerSpanID =  document.getElementById('PCSACPowerSpanID');
			PCSACPowerSpanID.textContent = item.PCSAC_Power + ' A';

			var PCSACVarSpanID =  document.getElementById('PCSACVarSpanID');
			PCSACVarSpanID.textContent = item.PCSAC_Var + ' A';


			document.getElementById('loading').style = "display:none; visibility:hidden;";
			document.getElementById('containerID').style = "";
		}
		
		
	</script>
</body>

</html>